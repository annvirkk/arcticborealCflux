---
title: "Quality Check Fluxnet Data"
author: "Isabel Wargowsky"
date: "2023-03-06"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
library(data.table)
library(ggplot2)
library(plyr)
library(dplyr)
library(svMisc)
library(plotrix)
library(zoo)
#load files
setwd("/Users/iwargowsky/Desktop/Fluxnet2015")
fluxnetdat <- read.csv("fluxnetpermonth.csv")

#create timestamp variable for x axis
fluxnetdat$ts = as.yearmon(paste(fluxnetdat$year,fluxnetdat$month,sep = '-'))
#assign variable for y axis
#ADJUST based on what variable you want to look at (ex: GPP, NEE, etc)
fluxnetdat$yvar <- fluxnetdat$NEE_VUT_REF
#assign quality check variable in relation to yvar 
fluxnetdat$QC <- fluxnetdat$NEE_VUT_REF_QC

#quick plot by site
ggplot(fluxnetdat)+
  geom_point(aes(ts,yvar))+
  facet_wrap(~site_id) 

```

```{r, label=CA-Gro, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='CA-Gro'))+theme_bw()+ggtitle('CA-Gro')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label=CA-Man, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='CA-Man'))+theme_bw()+ggtitle('CA-Man')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= CA-NS1, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='CA-NS1'))+theme_bw()+ggtitle('CA-NS1')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= CA-NS2, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='CA-NS2'))+theme_bw()+ggtitle('CA-NS2')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r,label= CA-NS3, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='CA-NS3'))+theme_bw()+ggtitle('CA-NS3')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= CA-NS4, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='CA-NS4'))+theme_bw()+ggtitle('CA-NS4')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r,label= CA-NS5,echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='CA-NS5'))+theme_bw()+ggtitle('CA-NS5')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= CA-NS6,cho=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='CA-NS6'))+theme_bw()+ggtitle('CA-NS6')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= CA-NS7,echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='CA-NS7'))+theme_bw()+ggtitle('CA-NS7')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= CA-Oas,echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='CA-Oas'))+theme_bw()+ggtitle('CA-Oas')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= CA-Obs,echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='CA-Obs'))+theme_bw()+ggtitle('CA-Obs')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= CA-Qfo,echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='CA-Qfo'))+theme_bw()+ggtitle('CA-Qfo')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= CA-SF1,echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='CA-SF1'))+theme_bw()+ggtitle('CA-SF1')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= CA-SF2, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='CA-SF2'))+theme_bw()+ggtitle('CA-SF2')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= CA-SF3, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='CA-SF3'))+theme_bw()+ggtitle('CA-SF3')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= FI-Hyy, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='FI-Hyy'))+theme_bw()+ggtitle('FI-Hyy')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= FI-Jok, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='FI-Jok'))+theme_bw()+ggtitle('FI-Jok')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= FI-Let, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='FI-Let'))+theme_bw()+ggtitle('FI-Let')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= FI-Lom, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='FI-Lom'))+theme_bw()+ggtitle('FI-Lom')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= FI-Sod, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='FI-Sod'))+theme_bw()+ggtitle('FI-Sod')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= GL-NuF, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='GL-NuF'))+theme_bw()+ggtitle('GL-NuF')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r,label= GL-ZaF, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='GL-ZaF'))+theme_bw()+ggtitle('GL-ZaF')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= GL-ZaH, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='GL-ZaH'))+theme_bw()+ggtitle('GL-ZaH')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= RU-Che, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='RU-Che'))+theme_bw()+ggtitle('RU-Che')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= RU-Cok, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='RU-Cok'))+theme_bw()+ggtitle('RU-Cok')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= RU-Fyo, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='RU-Fyo'))+theme_bw()+ggtitle('RU-Fyo')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= RU-Ha1, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='RU-Ha1'))+theme_bw()+ggtitle('RU-Ha1')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= RU-Sam, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='RU-Sam'))+theme_bw()+ggtitle('RU-Sam')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= RU-SkP, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='RU-SkP'))+theme_bw()+ggtitle('RU-SkP')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= RU-Tks, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='RU-Tks'))+theme_bw()+ggtitle('RU-Tks')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= RU-Vrk, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='RU-Vrk'))+theme_bw()+ggtitle('RU-Vrk')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= SE-St1, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='SE-St1'))+theme_bw()+ggtitle('SE-St1')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= SJ-Adv, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='SJ-Adv'))+theme_bw()+ggtitle('SJ-Adv')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= US-Atq, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='US-Atq'))+theme_bw()+ggtitle('US-Atq')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= US-Ivo, echo=FALSE}
ggplot(data = subset(fluxnetdat,fluxnetdat$site_id=='US-Ivo'))+theme_bw()+ggtitle('US-Ivo')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```