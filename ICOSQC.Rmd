---
title: "Quality Check ICOS Data"
author: "Isabel Wargowsky"
date: "2023-03-06"
output:
  word_document: default
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
library(ggplot2)
library(plyr)
library(dplyr)
library(svMisc)
library(plotrix)
#load files from ICOSdataprocessingDD.R
setwd("/Users/iwargowsky/Desktop/ICOS")
ICOSdat <- read.csv("ICOSdatapermonth.csv")

#create timestamp variable for x axis
ICOSdat$ts = paste(ICOSdat$year,ICOSdat$month,sep = '-')
#assign variable for y axis
#ADJUST based on what variable you want to look at (ex: GPP, NEE, etc)
ICOSdat$yvar <- ICOSdat$NEE_CUT_REF
#assign quality check variable in relation to yvar 
ICOSdat$QC <- ICOSdat$NEE_CUT_REF_QC

#quick plot of all sites
ggplot(ICOSdat)+
  geom_point(aes(ts,NEE_CUT_REF))+
  facet_wrap(~site_id)

```


```{r, label= FI-Hyy,echo=FALSE}
ggplot(data = subset(ICOSdat,ICOSdat$site_id=='FI-Hyy'))+theme_bw()+ggtitle('FI-Hyy')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```



```{r, label= FI-Ken, echo=FALSE}
ggplot(data = subset(ICOSdat,ICOSdat$site_id=='FI-Ken'))+theme_bw()+ggtitle('FI-Ken')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= FI-Let, echo=FALSE}
ggplot(data = subset(ICOSdat,ICOSdat$site_id=='FI-Let'))+theme_bw()+ggtitle('FI-Let')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= FI-Qvd, echo=FALSE}
ggplot(data = subset(ICOSdat,ICOSdat$site_id=='FI-Qvd'))+theme_bw()+ggtitle('FI-Qvd')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= FI-Sii, echo=FALSE}
ggplot(data = subset(ICOSdat,ICOSdat$site_id=='FI-Sii'))+theme_bw()+ggtitle('FI-Sii')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= FI-Var, echo=FALSE}
ggplot(data = subset(ICOSdat,ICOSdat$site_id=='FI-Var'))+theme_bw()+ggtitle('FI-Var')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= GL-Dsk, echo=FALSE}
ggplot(data = subset(ICOSdat,ICOSdat$site_id=='GL-Dsk'))+theme_bw()+ggtitle('GL-Dsk')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= RU-Fy2, echo=FALSE}
ggplot(data = subset(ICOSdat,ICOSdat$site_id=='RU-Fy2'))+theme_bw()+ggtitle('RU-Fy2')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= RU-Fyo, echo=FALSE}
ggplot(data = subset(ICOSdat,ICOSdat$site_id=='RU-Fyo'))+theme_bw()+ggtitle('RU-Fyo')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= SE-Deg, echo=FALSE}
ggplot(data = subset(ICOSdat,ICOSdat$site_id=='SE-Deg'))+theme_bw()+ggtitle('SE-Deg')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= SE-Lnn, echo=FALSE}
ggplot(data = subset(ICOSdat,ICOSdat$site_id=='SE-Lnn'))+theme_bw()+ggtitle('SE-Lnn')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= SE-Nor, echo=FALSE}
ggplot(data = subset(ICOSdat,ICOSdat$site_id=='SE-Nor'))+theme_bw()+ggtitle('SE-Nor')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= SE-Ros, echo=FALSE}
ggplot(data = subset(ICOSdat,ICOSdat$site_id=='SE-Ros'))+theme_bw()+ggtitle('SE-Ros')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```

```{r, label= SE-Svb, echo=FALSE}
ggplot(data = subset(ICOSdat,ICOSdat$site_id=='SE-Svb'))+theme_bw()+ggtitle('SE-Svb')+
  geom_hline(yintercept = 0)+
  geom_line(aes(ts,yvar, group= site_id))+
  geom_point(aes(ts,yvar, color= QC))+
  scale_color_gradient(low="blue", high="green")
```